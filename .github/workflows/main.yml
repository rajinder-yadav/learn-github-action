# This is a basic workflow to help you get started with Actions

name: Getting Started

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the "main" branch
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
    inputs:
      file_url:
        description: 'URL of the file to fetch'
        required: true
        default: 'https://jslib.k6.io/aws/0.14.0/s3.js'

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  fetch:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Run a one-line script
        id: download-k6-files
        uses: ./.github/actions/fetch-k6-libs
        with:
          artifactory_url: $ARTIFACTORY_URL
          artifactory_repo: "k6-jslib-utils"
          bmo_package_name: "@bmo-k6/k6-jslib-utils"
          k6_lib_tarball_url: "https://github.com/grafana/k6-jslib-utils/archive/refs/tags/v1.4.0.tar.gz"
          k6_lib_api_url: "https://api.github.com/repos/grafana/k6-jslib-utils/releases/latest"
